apiVersion: v1
kind: Secret
metadata:
  name: {{ include "cruisekube.fullname" . }}-postgresql-connection
  labels:
    {{- include "cruisekube.labels" . | nindent 4 }}
    app.kubernetes.io/component: postgresql
type: Opaque
data:
  {{- if .Values.postgresql.connection.url }}
  # External PostgreSQL connection password (extracted from URL if needed)
  {{- if .Values.postgresql.connection.password }}
  password: {{ .Values.postgresql.connection.password | b64enc | quote }}
  {{- end }}
  {{- else if .Values.postgresql.connection.password }}
  # External PostgreSQL connection password (from separate parameters)
  password: {{ .Values.postgresql.connection.password | b64enc | quote }}
  {{- else }}
  # Local PostgreSQL connection password
  password: {{ .Values.postgresql.local.password | b64enc | quote }}
  {{- end }}
